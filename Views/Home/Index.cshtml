@model List<UserAppointmentViewModel>

<style>
    .fs-7 {
    font-size: 0.8rem; /* daha küçük */
}
</style>



<div class="container mt-4">
    <h3 class="mb-4">📅 Randevularım</h3>

    <div class="row">
        @foreach (var item in Model)
        {
            <div class="col-4 mb-4">
                <div class="card shadow-sm border-0">
                    <div class="card-body">

                        <!-- Üst satır: Tarih - Saat -->
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div class="text-center bg-info-subtle p-2 rounded">
                                <div class="fw-bold fs-5">@item.AppointmentDate.ToString("dd")</div>
                                <div class="text-uppercase">@item.AppointmentDate.ToString("MMMM")</div>
                                <div>@item.AppointmentDate.ToString("yyyy")</div>
                            </div>
                            <div class="text-muted">
                                <i class="bi bi-clock"></i>
                                @item.AppointmentDate.ToString("HH:mm")
                            </div>
                        </div>

                        <h5 class="fw-bold text-primary mb-2">
                            @item.BusinessName
                        </h5>

                        <p class="mb-1 text-dark bold">
                            <i class="bi bi-capsule"></i>
                            @item.BusinessAdress
                        </p>

                        <p class="mb-2 text-muted">
                            <i class="bi bi-geo-alt"></i>
                            @item.BusinessDescrption
                        </p>

                        <p class="mb-3">
                            <span class="badge px-3 py-2 fs-7 rounded-pill 
                                            @(item.StatusText == "İptal" ? "bg-danger" :
                                            item.StatusText == "Bekliyor" ? "bg-warning text-dark" :
                                            "bg-success")">
                                @item.StatusText
                            </span>
                        </p>
                    @if(item.AppointmentDate > DateTime.Now){
                        <div class="d-grid">
                            <a href="/Edit/@item.AppointmentId" class="btn btn-outline-primary">
                                📌 Randevuya Git
                            </a>
                        </div>
                        } else{
                             <div class="d-grid">
                            <span  class="btn btn-danger" disabled style="pointer-events: none;">
                                Geçmiş Randevu
                            </span>
                        </div>
                        }                  
                    </div>
                </div>
            </div>
        }
    </div>
</div>



<script>
    document.addEventListener("DOMContentLoaded", function () {
        const deleteButtons = document.querySelectorAll(".btn-delete");

        deleteButtons.forEach(btn => {
            btn.addEventListener("click", function () {
                const jobId = this.getAttribute("data-id");

                Swal.fire({
                    title: "Emin misiniz?",
                    text: "Bu kaydı silmek üzeresiniz!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonText: "Evet, sil!",
                    cancelButtonText: "İptal"
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Silme isteğini gönder
                        fetch(`/Delete/${jobId}`, {
                            method: "POST"
                        }).then(() => {
                            Swal.fire("Silindi!", "Kayıt başarıyla silindi.", "success")
                                .then(() => {
                                    location.reload();
                                });
                        });
                    }
                });
            });
        });
    });
</script>